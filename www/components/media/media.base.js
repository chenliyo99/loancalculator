/**
 * @license Copyright 2013 - 2014 Intel Corporation All Rights Reserved.
 *
 * The source code, information and material ("Material") contained herein is owned by Intel Corporation or its
 * suppliers or licensors, and title to such Material remains with Intel Corporation or its suppliers or
 * licensors. The Material contains proprietary information of Intel or its suppliers and licensors. The
 * Material is protected by worldwide copyright laws and treaty provisions. No part of the Material may be used,
 * copied, reproduced, modified, published, uploaded, posted, transmitted, distributed or disclosed in any way
 * without Intel's prior express written permission. No license under any patent, copyright or other intellectual
 * property rights in the Material is granted to or conferred upon you, either expressly, by implication,
 * inducement, estoppel or otherwise. Any license under such intellectual property rights must be express and
 * approved by Intel in writing.
 *
 * Unless otherwise agreed by Intel in writing, you may not remove or alter this notice or any other notice
 * embedded in Materials by Intel or Intel's suppliers or licensors in any way.
 */
goog.provide("idr.components.MediaBase"),goog.require("idr.components.ComponentBase"),goog.require("idr.components.MediaCore"),goog.require("idr.debug"),idr.components.MediaBase=function(instanceId,data,parent){idr.components.ComponentBase.call(this,instanceId,data,parent),this._templateFactory=new idr.components.TemplateFactory,this._extensionsMapping={mp3:"AudioItem",wav:"AudioItem",ogg:"AudioItem",jpg:"SimpleImageItem",png:"SimpleImageItem",gif:"SimpleImageItem"},(void 0===data||null===data)&&(data={type:"content",padding:idr.components.MediaBase.PADDING.small,gridPadding:"padding-small",galleryType:idr.components.MediaBase.GALLERY_TYPE.single,imageStretchMode:idr.components.MediaBase.IMG_STRETCH_MODE.fit,mediaType:idr.components.MediaBase.MEDIA_TYPE.image,height:"idr-height-50",targetDataRange:"",mediaData:null}),this._mediaCore=null,this._padding=data.padding||idr.components.MediaBase.PADDING.small,this._gridPadding=data.gridPadding||"padding-small",this._galleryType=data.galleryType,this._height=data.height||"idr-height-50",this._imageStretchMode=data.imageStretchMode||idr.components.MediaBase.IMG_STRETCH_MODE.fit,this._currentItem=null,this._targetDataRange=data.targetDataRange,this._mediaData=data.mediaData,this._mediaDataRange=null,this._mediaType=data.mediaType,this.Binder.bind(this,"padding"),this.Binder.bind(this,"gridPadding"),this.Binder.bind(this,"galleryType"),this.Binder.bind(this,"imageStretchMode"),this.Binder.bind(this,"currentItem"),this.Binder.bind(this,"targetDataRange"),this.Binder.bind(this,"mediaData","mediaDataRange"),this.Binder.bind(this,"mediaType")},goog.inherits(idr.components.MediaBase,idr.components.ComponentBase),idr.components.MediaBase.GALLERY_TYPE={single:"SINGLE",grid:"GRID",carousel:"CAROUSEL",slide:"SLIDE"},idr.components.MediaBase.PADDING={none:"padding-none",small:"padding-small",medium:"padding-medium",large:"padding-large"},idr.components.MediaBase.IMG_STRETCH_MODE={stretch:"idr-image-stretch",fit:"idr-image-fit"},idr.components.MediaBase.MEDIA_TYPE={image:"SimpleImageItem",audio:"AudioItem",video:"VideoItem"},idr.components.MediaBase.DEFAULT_NAME_FIELD_POS=0,idr.components.MediaBase.prototype.getTypeName=function(){return"Media"},idr.components.MediaBase.prototype.rawObject=function(){var rawObject=idr.components.ComponentBase.prototype.rawObject.call(this);return rawObject.padding=this.padding(),rawObject.gridPadding=this.gridPadding(),rawObject.galleryType=this.galleryType(),rawObject.height=this.height(),rawObject.imageStretchMode=this.imageStretchMode(),rawObject.currentItem=this.currentItem(),rawObject.targetDataRange=this.targetDataRange(),rawObject.mediaData=this.mediaData(),rawObject.mediaType=this.mediaType(),rawObject},idr.components.MediaBase.prototype.componentDeleted=function(){this.Binder.unbind(this,"padding"),this.Binder.unbind(this,"gridPadding"),this.Binder.unbind(this,"galleryType"),this.Binder.unbind(this,"imageStretchMode"),this.Binder.unbind(this,"currentItem"),this.Binder.unbind(this,"targetDataRange"),this.Binder.unbind(this,"mediaData"),this.Binder.unbind(this,"mediaType"),idr.components.ComponentBase.prototype.componentDeleted.call(this)},idr.components.MediaBase.prototype.padding=function(){return this._padding},idr.components.MediaBase.prototype.setPadding=function(newPadding){this._padding=newPadding,this.triggerPropertyChanged("padding")},idr.components.MediaBase.prototype.gridPadding=function(){return this._gridPadding},idr.components.MediaBase.prototype.setGridPadding=function(newPadding){this._gridPadding=newPadding,this.triggerPropertyChanged("gridPadding")},idr.components.MediaBase.prototype.height=function(){return this._height},idr.components.MediaBase.prototype.setHeight=function(newHeight){this._height=newHeight,this.triggerPropertyChanged("height")},idr.components.MediaBase.prototype.imageStretchMode=function(){return this._imageStretchMode},idr.components.MediaBase.prototype.setImageStretchMode=function(imageStretchMode){this._imageStretchMode=imageStretchMode,this.triggerPropertyChanged("imageStretchMode")},idr.components.MediaBase.prototype.targetDataRange=function(){return this._targetDataRange},idr.components.MediaBase.prototype.setTargetDataRange=function(targetDataRange){this._targetDataRange=targetDataRange,this.triggerPropertyChanged("targetDataRange")},idr.components.MediaBase.prototype.galleryType=function(){return this._galleryType},idr.components.MediaBase.prototype.setGalleryType=function(galleryType){this._galleryType=galleryType,this.triggerPropertyChanged("galleryType")},idr.components.MediaBase.prototype.currentItem=function(){return this._currentItem},idr.components.MediaBase.prototype.setCurrentItem=function(currentItem){this._currentItem=currentItem,this.triggerPropertyChanged("currentItem")},idr.components.MediaBase.prototype.mediaData=function(){return this._mediaData},idr.components.MediaBase.prototype.setMediaData=function(mediaData){this._mediaData=mediaData,this.triggerPropertyChanged("mediaData")},idr.components.MediaBase.prototype.mediaDataRange=function(){return this._mediaDataRange},idr.components.MediaBase.prototype.setMediaDataRange=function(mediaData){this._mediaDataRange=mediaData,this.triggerPropertyChanged("mediaDataRange")},idr.components.MediaBase.prototype.mediaType=function(){return this._mediaType},idr.components.MediaBase.prototype.setMediaType=function(newMediaType){this._mediaType=newMediaType,this.triggerPropertyChanged("mediaType")},idr.components.MediaBase.prototype.setDataItems=function(items){for(var itemTemplate=null,medias=[],i=0;i<items.length;i++)if(itemTemplate=this.createItemTemplate(items[i][idr.components.MediaBase.DEFAULT_NAME_FIELD_POS].value)){for(var f=0;f<items[i].length;f++){var itemId=this.itemId(items[i][f].item);itemTemplate.setData({id:itemId,field:items[i][f].field,value:items[i][f].value})}medias.push(itemTemplate)}this._mediaCore.setItems(medias)},idr.components.MediaBase.prototype.setDataItem=function(data){var itemId=this.itemId(data.item),item=this._mediaCore.getItemById(itemId);if(item){if(data.field===idr.components.MediaBase.DEFAULT_NAME_FIELD_POS){var newItem=this.createItemTemplate(data.value);newItem.constructor!==item.constructor&&(item=newItem)}}else item=this.createItemTemplate(data.value);item&&(item.setData({id:itemId,field:data.field,value:data.value}),this._mediaCore.add(1,item))},idr.components.MediaBase.prototype.setMediaItems=function(data){this._mediaCore.setComponentConfigured(),data instanceof Array?this.setDataItems(data):this.setDataItem(data)},idr.components.MediaBase.prototype.setNeedsConfigurationIfNeeded=function(){(null===this._mediaData||""===this._mediaData.trim())&&this._mediaCore.setUpNeedsConfigurationMarkup()},idr.components.MediaBase.prototype.createItemTemplate=function(mediaName){var extensionIndex=mediaName.lastIndexOf("."),itemTemplate=null;if(-1!==extensionIndex){var extension=mediaName.substr(extensionIndex+1).toLowerCase();itemTemplate=this._templateFactory.create(this._extensionsMapping[extension],null)}else itemTemplate=this._templateFactory.create("BlankItem",null);return itemTemplate};