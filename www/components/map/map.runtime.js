/**
 * @license Copyright 2013 - 2014 Intel Corporation All Rights Reserved.
 *
 * The source code, information and material ("Material") contained herein is owned by Intel Corporation or its
 * suppliers or licensors, and title to such Material remains with Intel Corporation or its suppliers or
 * licensors. The Material contains proprietary information of Intel or its suppliers and licensors. The
 * Material is protected by worldwide copyright laws and treaty provisions. No part of the Material may be used,
 * copied, reproduced, modified, published, uploaded, posted, transmitted, distributed or disclosed in any way
 * without Intel's prior express written permission. No license under any patent, copyright or other intellectual
 * property rights in the Material is granted to or conferred upon you, either expressly, by implication,
 * inducement, estoppel or otherwise. Any license under such intellectual property rights must be express and
 * approved by Intel in writing.
 *
 * Unless otherwise agreed by Intel in writing, you may not remove or alter this notice or any other notice
 * embedded in Materials by Intel or Intel's suppliers or licensors in any way.
 */
goog.provide("idr.runtime.Map"),goog.require("idr.runtime.ComponentRuntime"),goog.require("idr.components.MapBase"),idr.runtime.Map=function(id,data,parent){idr.components.MapBase.call(this,id,data,parent),this.initializeRuntime(data),this.loadCss("map","map.runtime.css"),this._view=null,this._mapView=null,this.addPropertyChangedHandler("padding",function(){this._view.removeClass(function(index,css){return(css.match(/\bidr-map-padding-\S+/g)||[]).join(" ")}),this._view.addClass(this.padding())}),this.addPropertyChangedHandler("height",function(){this.Parent.updateChildComponentHeight(this,this.height())}),this.addPropertyChangedHandler("currentLocationEnabled",function(){this.MapController.showUserLocation(this.currentLocationEnabled())}),this.addPropertyChangedHandler("pointsDataRange",function(){this.updatePointsDataRange(this.pointsDataRange())}),this.addPropertyChangedHandler("popupTemplate",function(){this.changePopupTemplate(this.popupTemplate())}),this.addPropertyChangedHandler("contentResize",function(){this.updateResizeContent()}),this.addOnPointSelectedHandler(function(event,point){this.pointSelected(point)}),parent.addChildComponentLoaded(this)},goog.inherits(idr.runtime.Map,idr.components.MapBase),goog.mixin(idr.runtime.Map.prototype,idr.runtime.ComponentRuntime.prototype),idr.runtime.Map.prototype.render=function(){null===this._view&&(this._view=$('<div class="idr-map-container"></div>'),this._mapView=$('<div class="idr-map" data-ignore-slide="true"></div>'),this._view.addClass(this.padding()),this._view.append(this._mapView),this.initializeMapController(this._mapView))},idr.runtime.Map.prototype.view=function(){return null===this._view&&this.render(),this._view},idr.runtime.Map.prototype.componentDeleted=function(){idr.components.MapBase.prototype.componentDeleted.call(this)},idr.runtime.Map.prototype.updatePointsDataRange=function(data){this.MapController.addOrUpdatePoints(data)},idr.runtime.Map.prototype.changePopupTemplate=function(popupTemplate){this.MapController.setPopupTemplate(popupTemplate)},idr.runtime.Map.prototype.pointSelected=function(point){var id=parseInt(point.key,10),selectionRange=this.dataSelectionRange();if(""!==selectionRange&&!isNaN(id)){var copyOnlyValues=this.copyValues();this.Binder.copySelectedItem("default",id,this.pointsData(),selectionRange,copyOnlyValues)}this.fireEvent("ONMARKERCLICK")},idr.runtime.Map.prototype.updateResizeContent=function(){var resizeData=this.contentResize();"height"===resizeData.type&&this._mapView.height(resizeData.height),this.MapController.notifyResize()},idr.runtime.Map.prototype.parentComponentLoaded=function(){this.MapController&&this.MapController.notifyResize()},idr.runtime.Map.prototype.componentAdded=function(){this.MapController&&this.MapController.notifyResize()};