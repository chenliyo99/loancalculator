/**
 * @license Copyright 2013 - 2014 Intel Corporation All Rights Reserved.
 *
 * The source code, information and material ("Material") contained herein is owned by Intel Corporation or its
 * suppliers or licensors, and title to such Material remains with Intel Corporation or its suppliers or
 * licensors. The Material contains proprietary information of Intel or its suppliers and licensors. The
 * Material is protected by worldwide copyright laws and treaty provisions. No part of the Material may be used,
 * copied, reproduced, modified, published, uploaded, posted, transmitted, distributed or disclosed in any way
 * without Intel's prior express written permission. No license under any patent, copyright or other intellectual
 * property rights in the Material is granted to or conferred upon you, either expressly, by implication,
 * inducement, estoppel or otherwise. Any license under such intellectual property rights must be express and
 * approved by Intel in writing.
 *
 * Unless otherwise agreed by Intel in writing, you may not remove or alter this notice or any other notice
 * embedded in Materials by Intel or Intel's suppliers or licensors in any way.
 */
goog.provide("idr.runtime.RssFeed"),goog.require("idr.runtime.ComponentRuntime"),goog.require("idr.components.RssFeedBase"),goog.require("idr.runtime.RssFeedReader"),idr.runtime.RssFeed=function(id,data,parent){idr.components.RssFeedBase.call(this,id,data,parent),this.initializeRuntime(data),this._view=null,this.addPropertyChangedHandler("url",function(){this.autoLoad()&&this.loadRssFeed()}),this.addPropertyChangedHandler("targetRange",function(){this.autoLoad()&&""!==this.url()&&this.loadRssFeed()})},goog.inherits(idr.runtime.RssFeed,idr.components.RssFeedBase),goog.mixin(idr.runtime.RssFeed.prototype,idr.runtime.ComponentRuntime.prototype),idr.runtime.RssFeed.MAX_RESULT_NUMBER=15,idr.runtime.RssFeed.TIMEOUT=8e3,idr.runtime.RssFeed.prototype.load=function(){var that=this;setTimeout(function(){that.loadRssFeed()},100)},idr.runtime.RssFeed.prototype.render=function(){null===this._view&&(this._view=$("<div></div>"))},idr.runtime.RssFeed.prototype.view=function(){return null===this._view&&this.render(),this._view},idr.runtime.RssFeed.prototype.componentDeleted=function(){idr.components.RssFeedBase.prototype.componentDeleted.call(this)},idr.runtime.RssFeed.prototype.loadRssFeed=function(){var that=this;if(this.url()&&this.targetRange()){this.onFeedLoading();var feedReader=new idr.runtime.RssFeedReader;feedReader.load(this.url(),function(data){that.onFeedLoaded(data)},function(error){that.onFeedError(error)})}},idr.runtime.RssFeed.prototype.onFeedLoading=function(){this.setStateMessage("Loading...")},idr.runtime.RssFeed.prototype.onFeedLoaded=function(data){var dataArray=[];if(dataArray[0]=["DATE","IMAGE","TITLE","SHORT DESCRIPTION","FULL DESCRIPTION","LINK"],null!==data)for(var i=0;i<data.entries.length;i++){var item=[];item.push(data.entries[i].date),item.push(data.entries[i].image),item.push(data.entries[i].title),item.push(data.entries[i].contentSnippet),item.push(data.entries[i].content),item.push(data.entries[i].link),dataArray.push(item)}this.Binder.setWorkbookValues("default",this.targetRange(),dataArray),this.Binder.setHeaderStyle("default",this.targetRange()),this.fireEvent("ONLOAD")},idr.runtime.RssFeed.prototype.onFeedError=function(error){this.setStateMessage(error)},idr.runtime.RssFeed.prototype.setStateMessage=function(message){var data=[],error=[];error[2]=message,data[1]=error;var that=this;setTimeout(function(){that.Binder.setWorkbookValues("default",that.targetRange(),data)},0)};