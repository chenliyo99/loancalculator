/**
 * @license Copyright 2013 - 2014 Intel Corporation All Rights Reserved.
 *
 * The source code, information and material ("Material") contained herein is owned by Intel Corporation or its
 * suppliers or licensors, and title to such Material remains with Intel Corporation or its suppliers or
 * licensors. The Material contains proprietary information of Intel or its suppliers and licensors. The
 * Material is protected by worldwide copyright laws and treaty provisions. No part of the Material may be used,
 * copied, reproduced, modified, published, uploaded, posted, transmitted, distributed or disclosed in any way
 * without Intel's prior express written permission. No license under any patent, copyright or other intellectual
 * property rights in the Material is granted to or conferred upon you, either expressly, by implication,
 * inducement, estoppel or otherwise. Any license under such intellectual property rights must be express and
 * approved by Intel in writing.
 *
 * Unless otherwise agreed by Intel in writing, you may not remove or alter this notice or any other notice
 * embedded in Materials by Intel or Intel's suppliers or licensors in any way.
 */
goog.provide("idr.workbook.CellFormat"),goog.provide("idr.workbook.CellFormat.FormatType"),goog.require("goog.date.Date"),goog.require("goog.i18n.DateTimeFormat"),goog.require("goog.i18n.DateTimeFormat.Format"),goog.require("goog.i18n.NumberFormat"),goog.require("goog.i18n.NumberFormat.Format"),idr.workbook.CellFormat=function(cell){this._cell=cell,this._formatedValue=cell.Value,this._formatType=idr.workbook.CellFormat.FormatType.TEXT,this._formatExpression=null},idr.workbook.CellFormat.prototype.FormatNumbers=function(value,pattern){var formatedValue=value;if(null!==value&&void 0!==value){var nrFormat=new goog.i18n.NumberFormat(pattern);formatedValue=value.toString(),idr.workbook.CellFormat.checkNumber(value)?(this.Cell.setAlignment("right"),formatedValue=nrFormat.format(value)):this.Cell.setAlignment("left")}return formatedValue},idr.workbook.CellFormat.FormatType={TEXT:0,NUMBER:1,CURRENCY:2,PERCENTAGE:3,DATE:4},idr.workbook.CellFormat.FORMAT_FUNCTION={0:function(value){var formatedValue=value;return null!==value&&void 0!==value&&"string"!=typeof value&&(formatedValue=value.toString()),this.Cell.setAlignment("left"),formatedValue},1:function(value,expression){var pattern=expression||"0.00";return this.FormatNumbers(value,pattern)},2:function(value,expression){var pattern=expression||goog.i18n.NumberFormat.Format.CURRENCY;return this.FormatNumbers(value,pattern)},3:function(value,expression){var pattern=expression||goog.i18n.NumberFormat.Format.PERCENT;return this.FormatNumbers(value,pattern)},4:function(value,expression){var pattern=expression||goog.i18n.DateTimeFormat.Format.SHORT_DATE,formatedValue=value,formater=new goog.i18n.DateTimeFormat(pattern);if(null!==value&&void 0!==value&&"string"==typeof value){var date=new Date(value);isNaN(date.getDate())||(this.Cell.setAlignment("right"),formatedValue=formater.format(date))}return formatedValue}},idr.workbook.CellFormat.addFormatToCell=function(cell,type,expression){var format=new idr.workbook.CellFormat(cell);format.FormatType=type,format.FormatExpression=void 0!==expression?expression:null,cell.CellFormat=format,cell.CellFormat.format()},idr.workbook.CellFormat.copyFormat=function(cell,format){if(null!==cell&&null!==format&&void 0!==format){var newFormat=new idr.workbook.CellFormat(cell);newFormat.FormatType=format.FormatType,newFormat.FormatExpression=format.FormatExpression,cell.CellFormat=newFormat,cell.CellFormat.format()}},idr.workbook.CellFormat.applyInitialFormat=function(cell){var format=new idr.workbook.CellFormat(cell);format.FormatType=format.guessFormatType(),cell.CellFormat=format,cell.CellFormat.format()},Object.defineProperty(idr.workbook.CellFormat.prototype,"Cell",{get:function(){return this._cell},set:function(value){this._cell=value}}),Object.defineProperty(idr.workbook.CellFormat.prototype,"FormatedValue",{get:function(){return this._formatedValue}}),Object.defineProperty(idr.workbook.CellFormat.prototype,"FormatType",{get:function(){return this._formatType},set:function(value){this._formatType=value}}),Object.defineProperty(idr.workbook.CellFormat.prototype,"FormatExpression",{get:function(){return this._formatExpression},set:function(value){this._formatExpression=value}}),idr.workbook.CellFormat.prototype.format=function(){void 0!==this.FormatType&&null!==this.FormatType&&(this._formatedValue=idr.workbook.CellFormat.FORMAT_FUNCTION[this.FormatType].call(this,this.Cell.Value,this.FormatExpression))},idr.workbook.CellFormat.prototype.guessFormatType=function(){return""===this._formatedValue||idr.workbook.CellFormat.checkNumber(this._formatedValue)?idr.workbook.CellFormat.FormatType.NUMBER:idr.workbook.CellFormat.FormatType.TEXT},idr.workbook.CellFormat.prototype.isText=function(){return this._formatType===idr.workbook.CellFormat.FormatType.TEXT},idr.workbook.CellFormat.prototype.isNumber=function(){return this._formatType===idr.workbook.CellFormat.FormatType.NUMBER},idr.workbook.CellFormat.prototype.isPercentage=function(){return this._formatType===idr.workbook.CellFormat.FormatType.PERCENTAGE},idr.workbook.CellFormat.prototype.isDate=function(){return this._formatType===idr.workbook.CellFormat.FormatType.DATE},idr.workbook.CellFormat.prototype.isCurrency=function(){return this._formatType===idr.workbook.CellFormat.FormatType.CURRENCY},idr.workbook.CellFormat.prototype.toJson=function(){var jsonObject={type:this.FormatType,expression:this.FormatExpression};return jsonObject},idr.workbook.CellFormat.prototype.loadFromJson=function(json){this.FormatType=json.type||this.FormatType,this.FormatExpression=json.expression||this.FormatExpression},idr.workbook.CellFormat.checkNumber=function(value){if(void 0!==value&&null!==value&&""!==value){var regex=new RegExp("^(-?\\d+)?\\.?(\\d+)?$");return regex.test(value)}return!1};