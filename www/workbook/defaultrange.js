/**
 * @license Copyright 2013 - 2014 Intel Corporation All Rights Reserved.
 *
 * The source code, information and material ("Material") contained herein is owned by Intel Corporation or its
 * suppliers or licensors, and title to such Material remains with Intel Corporation or its suppliers or
 * licensors. The Material contains proprietary information of Intel or its suppliers and licensors. The
 * Material is protected by worldwide copyright laws and treaty provisions. No part of the Material may be used,
 * copied, reproduced, modified, published, uploaded, posted, transmitted, distributed or disclosed in any way
 * without Intel's prior express written permission. No license under any patent, copyright or other intellectual
 * property rights in the Material is granted to or conferred upon you, either expressly, by implication,
 * inducement, estoppel or otherwise. Any license under such intellectual property rights must be express and
 * approved by Intel in writing.
 *
 * Unless otherwise agreed by Intel in writing, you may not remove or alter this notice or any other notice
 * embedded in Materials by Intel or Intel's suppliers or licensors in any way.
 */
goog.provide("idr.workbook.DefaultRange"),goog.require("idr.workbook.Range"),goog.require("idr.workbook.CellHelper"),goog.require("idr.debug"),idr.workbook.DefaultRange=function(name){this._name=name,this._firstCell=null,this._lastCell=null,this._firstLetter=null,this._lastLetter=null,this._firstRow=null,this._lastRow=null,this._firstRowCol=null,this._lastRowCol=null,this._valid=!1,this._name&&(this._name=this._name.toUpperCase(),this.parseRange())},idr.workbook.DefaultRange.RANGE_CELL_SEPARATOR=":",idr.workbook.DefaultRange.RANGE_NAME_REGEX="^("+idr.workbook.CellHelper.CELL_NAME_REGEX+")"+idr.workbook.DefaultRange.RANGE_CELL_SEPARATOR+"("+idr.workbook.CellHelper.CELL_NAME_REGEX+")$",idr.workbook.DefaultRange.validate=function(rangeName){return rangeName?(rangeName=rangeName.toUpperCase(),rangeName.match(RegExp(idr.workbook.DefaultRange.RANGE_NAME_REGEX))):null},idr.workbook.DefaultRange.prototype.isValid=function(){return this._valid},idr.workbook.DefaultRange.prototype.parseRange=function(){var matchArray=idr.workbook.DefaultRange.validate(this._name);if(null!==matchArray){this._firstCell=matchArray[1],this._lastCell=matchArray[4];var firstCellRowCol=idr.workbook.CellHelper.cellNameToRowColumn(this._firstCell),lastCellRowCol=idr.workbook.CellHelper.cellNameToRowColumn(this._lastCell);if(firstCellRowCol.row>lastCellRowCol.row){var row=lastCellRowCol.row;lastCellRowCol.row=firstCellRowCol.row,firstCellRowCol.row=row}if(firstCellRowCol.column>lastCellRowCol.column){var column=lastCellRowCol.column;lastCellRowCol.column=firstCellRowCol.column,firstCellRowCol.column=column}this._firstCell=idr.workbook.CellHelper.rowColumnToCellName(firstCellRowCol.row,firstCellRowCol.column),this._lastCell=idr.workbook.CellHelper.rowColumnToCellName(lastCellRowCol.row,lastCellRowCol.column);var splitedFirstCell=idr.workbook.CellHelper.validate(this._firstCell),splitedLastCell=idr.workbook.CellHelper.validate(this._lastCell);this._firstLetter=splitedFirstCell[1],this._firstRow=splitedFirstCell[2],this._lastLetter=splitedLastCell[1],this._lastRow=splitedLastCell[2],this._firstRowCol=idr.workbook.CellHelper.cellNameToRowColumn(this._firstCell),this._lastRowCol=idr.workbook.CellHelper.cellNameToRowColumn(this._lastCell),this._name=this._firstCell+idr.workbook.DefaultRange.RANGE_CELL_SEPARATOR+this._lastCell,this._valid=!0}else this._valid=!1},idr.workbook.DefaultRange.prototype.getName=function(){return this._name},idr.workbook.DefaultRange.prototype.getCellOrRangeName=function(){return this._firstCell===this._lastCell?this._firstCell:this._name},idr.workbook.DefaultRange.prototype.getFirst=function(){return this._firstCell},idr.workbook.DefaultRange.prototype.getLast=function(){return this._lastCell},idr.workbook.DefaultRange.prototype.getFirstRowCol=function(){return this._firstRowCol},idr.workbook.DefaultRange.prototype.getLastRowCol=function(){return this._lastRowCol},idr.workbook.DefaultRange.prototype.getRangeForRow=function(row){var range="",rowIndex=this._firstRowCol.row+row;if(rowIndex>=this._firstRowCol.row&&rowIndex<=this._lastRowCol.row){var firstCell=idr.workbook.CellHelper.rowColumnToCellName(rowIndex,this._firstRowCol.column),lastCell=idr.workbook.CellHelper.rowColumnToCellName(rowIndex,this._lastRowCol.column);range=firstCell+idr.workbook.DefaultRange.RANGE_CELL_SEPARATOR+lastCell}return range},idr.workbook.DefaultRange.prototype.getRangeForColumn=function(){return null},idr.workbook.DefaultRange.prototype.getColumnsHeader=function(){for(var firstCol=this._firstLetter.charCodeAt(0)-65,lastCol=this._lastLetter.charCodeAt(0)-65,start=lastCol>firstCol?firstCol:lastCol,end=lastCol>firstCol?lastCol:firstCol,colLetters=[],i=start;end>=i;i++){var value=String.fromCharCode(i+65);colLetters.push(value)}return colLetters},idr.workbook.DefaultRange.prototype.getRowsLabels=function(){for(var rows=[],firstRowValue=0|this._firstRow,len=(0|this._lastRow)-firstRowValue,i=0;len>=i;i++)rows.push(firstRowValue+i);return rows},idr.workbook.DefaultRange.prototype.expandRange=function(){return[]},idr.workbook.DefaultRange.prototype.getRangeArray=function(){for(var result=[],rowCount=this._lastRowCol.row-this._firstRowCol.row,columnCount=this._lastRowCol.column-this._firstRowCol.column,r=0;rowCount>=r;r++){for(var row=[],c=0;columnCount>=c;c++)row.push(idr.workbook.CellHelper.rowColumnToCellName(this._firstRowCol.row+r,this._firstRowCol.column+c));result.push(row)}return result},idr.workbook.DefaultRange.prototype.getRelativeRowCol=function(cellName){var relativeRowCol=-1,cellRowCol=idr.workbook.CellHelper.cellNameToRowColumn(cellName);return cellRowCol.row>=this._firstRowCol.row&&cellRowCol.row<=this._lastRowCol.row&&cellRowCol.column>=this._firstRowCol.column&&cellRowCol.column<=this._lastRowCol.column&&(relativeRowCol={row:cellRowCol.row-this._firstRowCol.row,column:cellRowCol.column-this._firstRowCol.column}),relativeRowCol},idr.workbook.DefaultRange.prototype.countRows=function(){return this._lastRowCol.row-this._firstRowCol.row+1},idr.workbook.DefaultRange.prototype.countColumns=function(){return this._lastRowCol.column-this._firstRowCol.column+1},idr.workbook.DefaultRange.rowColumnToRangeName=function(firstCell,lastCell){var rangeName=null;if("object"==typeof firstCell&&"object"==typeof lastCell&&void 0!==firstCell.row&&void 0!==firstCell.column&&void 0!==lastCell.row&&void 0!==lastCell.column){var first=idr.workbook.CellHelper.rowColumnToCellName(firstCell.row,firstCell.column),last=idr.workbook.CellHelper.rowColumnToCellName(lastCell.row,lastCell.column);rangeName=first+idr.workbook.DefaultRange.RANGE_CELL_SEPARATOR+last}return rangeName},idr.workbook.DefaultRange.rangeNameToRowColumn=function(rangeName){var matchArray=idr.workbook.DefaultRange.validate(rangeName),firstRowColumn=null,lastRowColumn=null;return matchArray&&(firstRowColumn=idr.workbook.CellHelper.cellNameToRowColumn(matchArray[1]),lastRowColumn=idr.workbook.CellHelper.cellNameToRowColumn(matchArray[4])),[firstRowColumn,lastRowColumn]},idr.workbook.DefaultRange.NormalizeRangeName=function(rangeName){var matchArray=idr.workbook.DefaultRange.validate(rangeName),normalizedRangeName="";if(null!==matchArray){var firstCell=matchArray[1],lastCell=matchArray[4],firstCellRowCol=idr.workbook.CellHelper.cellNameToRowColumn(firstCell),lastCellRowCol=idr.workbook.CellHelper.cellNameToRowColumn(lastCell);if(firstCellRowCol.row>lastCellRowCol.row){var row=lastCellRowCol.row;lastCellRowCol.row=firstCellRowCol.row,firstCellRowCol.row=row}if(firstCellRowCol.column>lastCellRowCol.column){var column=lastCellRowCol.column;lastCellRowCol.column=firstCellRowCol.column,firstCellRowCol.column=column}firstCell=idr.workbook.CellHelper.rowColumnToCellName(firstCellRowCol.row,firstCellRowCol.column),lastCell=idr.workbook.CellHelper.rowColumnToCellName(lastCellRowCol.row,lastCellRowCol.column),normalizedRangeName=firstCell+idr.workbook.DefaultRange.RANGE_CELL_SEPARATOR+lastCell}return normalizedRangeName};